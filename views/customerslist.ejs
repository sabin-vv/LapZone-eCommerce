<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LapZone Dashboard - Customers</title>
    <link rel="stylesheet" href="/css/customerslist.css">
    <link rel="stylesheet" href="/css/sidebar.css">
    <style>
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ef4444;
            transition: 0.4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 3px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #10b981;
        }

        input:checked + .slider:before {
            transform: translateX(24px);
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <%- include("../views/partials/admin/sidebar.ejs") %>
        <main class="main-content">
            <header class="header">
                <h2>Customer List</h2>
                <div class="user-section">
                    <span>Admin</span>
                    <div class="avatar"></div>
                </div>
            </header>
            <div class="container mx-auto p-6">
                <div class="customers">
                    <div class="products">
                        <table class="product-table" id="productTable">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Mobile</th>
                                    <th>Joining Date</th>
                                    <th>Status</th>
                                    <th>Block/Unblock</th>
                                    <th>Info</th>
                                </tr>
                            </thead>
                            <tbody id="productList">
                                <% users.forEach(user => { %>
                                    <tr data-user-id="<%= user._id %>">
                                        <td><%= user.fullname %></td>
                                        <td><%= user.email %></td>
                                        <td><%= user.mobile %></td>
                                        <td><%= user.createdAt.toLocaleString('en-IN', { dateStyle: 'medium', timeStyle: 'short' }) %></td>
                                        <td class="status"><%= user.isBlocked ? "Blocked" : "Active" %></td>
                                        <td>
                                            <form action="/admin/customer-block-unblock/<%= user._id %>?page=<%= currentPage || 1 %>" method="post">
                                                <input type="hidden" name="isBlocked" value="<%= !user.isBlocked %>">
                                                <label class="switch">
                                                    <input type="checkbox" <%= user.isBlocked ? '' : 'checked' %> onchange="this.form.submit()">
                                                    <span class="slider"></span>
                                                </label>
                                            </form>
                                        </td>
                                        <td><button class="info-btn">Info</button></td>
                                    </tr>
                                <% }) %>
                            </tbody>
                        </table>
                        <div class="pagination">
                            <% if (currentPage > 1) { %>
                                <a href="?page=<%= currentPage - 1 %>" class="border rounded px-3 py-2">Previous</a>
                            <% } %>
                            <% for (let i = 1; i <= totalPages; i++) { %>
                                <a href="?page=<%= i %>" class="border rounded px-3 py-2 <%= currentPage === i ? 'active' : '' %>"><%= i %></a>
                            <% } %>
                            <% if (currentPage < totalPages) { %>
                                <a href="?page=<%= currentPage + 1 %>" class="border rounded px-3 py-2">Next</a>
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</body>
</html>